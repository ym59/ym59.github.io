<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Building the ADMET AI Module for InstaDock v2</title>
  <meta name="description" content="A look behind the curtain at how the ADMET prediction engine for InstaDock v2 came to life: datasets, models, optimization, deployment issues, and lessons learned along the way.">
  <meta property="og:title" content="Building the ADMET AI Module for InstaDock v2">
  <meta property="og:description" content="A look behind the curtain at how the ADMET prediction engine for InstaDock v2 came to life: datasets, models, optimization, deployment issues, and lessons learned along the way.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://ym59.github.io/blogs/posts/building-the-admet-ai-module-for-instadock-v2.html">
  <meta property="og:image" content="https://ym59.github.io/images/YM.png">
  <meta property="article:published_time" content="Aug 22, 2025">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Building the ADMET AI Module for InstaDock v2">
  <meta name="twitter:description" content="A look behind the curtain at how the ADMET prediction engine for InstaDock v2 came to life: datasets, models, optimization, deployment issues, and lessons learned along the way.">
  <meta name="keywords" content="InstaDock, AI, Software Dev, Cheminformatics, Machine Learning">

  <link rel="icon" href="../../images/YM.ico" />
  <link rel="stylesheet" href="../styles/post-common.css">
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --text:#cbd5e1;
      --muted:#94a3b8;
      --accent:#7dd3fc;
      --accent-2:#60a5fa;
      --glass:rgba(255,255,255,0.03);
      --radius:14px;
      color-scheme:dark;
      font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
    }
    html.light{
      --bg:#f7fafc;
      --card:#ffffff;
      --text:#0b1220;
      --muted:#536171;
      --accent:#0ea5e9;
      --accent-2:#2563eb;
      --glass:rgba(2,6,23,0.05);
      color-scheme:light;
    }

    html,body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
    }
	
	.content,
	.content p,
	.content li,
	.content .callout,
	.content .callout p {
	  text-align: justify;
	  text-justify: inter-word;
	  hyphens: auto;
	  /* keep the last line readable rather than stretched */
	  text-align-last: left;
	}
	
	/* Optional: keep small UI elements unaffected */
	.meta, .post-top, .tags, .tag, h1, h3 {
	  text-align: left;
	}

	  
    .container{max-width:900px;margin:0 auto;padding:28px 20px}
    h1{color:var(--accent-2)}
    .meta{color:var(--muted);font-size:0.95rem;margin-bottom:14px}
    .tags{margin-top:18px}
    .tag{display:inline-block;background:var(--glass);padding:6px 10px;border-radius:999px;margin-right:8px;color:var(--accent);border:1px solid rgba(125,211,252,0.15)}
    a.home{display:inline-block;margin-top:18px;color:var(--accent-2);text-decoration:none}
    a.home:hover{text-decoration:underline}
    .content{line-height:1.75;color:var(--text)}
    .callout{background:var(--card);border:1px solid var(--glass);padding:12px 14px;border-radius:10px}

    .post-top{display:flex;align-items:center;gap:12px;margin-bottom:6px}
    .spacer{flex:1}

	.theme-toggle{
	  width:40px;
	  height:40px;
	  padding:0;
	  border-radius:10px;
	  cursor:pointer;
	  border:1px solid var(--glass);
	  background:transparent;
	  display:inline-flex;
	  align-items:center;
	  justify-content:center;
	  color:var(--muted);
	  line-height:0;
	  box-sizing:border-box;
	}
	.theme-toggle svg{
	  width:22px;
	  height:22px;
	  display:block;
	  overflow:visible;
	}
  </style>
</head>
<body>
  <div class="container">
    <div class="post-top">
      <a href="../nav.html" class="home">← Back to blog</a>
      <div class="spacer"></div>

    <button class="theme-toggle" id="themeToggle" aria-pressed="false" title="Toggle theme">
	  <svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
		   fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
		<circle cx="12" cy="12" r="4"></circle>
		<path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41"></path>
	  </svg>
	  <svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
		   fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
		<path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
	  </svg>
	</button>
    </div>
    <h1>Building the ADMET AI Module for InstaDock v2</h1>
    <div class="meta">Published: Aug 22, 2025 • Author: Yash Mathur</div>

    <div class="content">
      
      <h3>When docking scores stopped being enough</h3>
      <p>
        InstaDock had already earned a reputation for being fast, practical, and reasonably accurate. It could process compounds, score them, and make researchers feel like they were watching molecular matchmaking happen in real time. 
        But there was one question that kept surfacing.  
        <em>“Great score, but will it ever work in a real system?”</em>  
        A compound that binds tightly yet fails on solubility, permeability, or toxicity is not a success story. It is a false start.  
        That realization became the reason to build an ADMET prediction engine within InstaDock v2.
      </p>

      <h3>Before the model, there was the data mountain</h3>
      <p>
        Anyone who has done applied machine learning knows that model building is the easy part. The real work is data cleaning. 
        Hours go into handling inconsistent entries, missing values, and duplicate molecules that somehow refuse to behave.  
        For this project, I assembled data from public repositories such as <strong>TDCommons</strong> and <strong>DeepPK</strong>. Each source needed its own curation strategy.  
        Once standardized and cross-validated, these datasets formed the backbone of the ADMET module.
      </p>
      <p>
        Each endpoint told a different story. Some were well-behaved and balanced, others deeply biased. 
        Toxicity endpoints were particularly challenging since positive samples were rare.  
        Without careful handling, the model could have learned to label almost everything as non-toxic and still appear accurate. Balancing these datasets required time and restraint.
      </p>

      <h3>Teaching molecules to communicate</h3>
      <p>
        The architecture of choice was a <strong>Directed Message Passing Neural Network (DMPNN)</strong>.  
        Unlike descriptor-based approaches that treat molecules as fixed vectors, DMPNNs allow the network to learn directly from the chemical graph.  
        It is a structure-driven way to make the model understand interactions that would be invisible to static fingerprints.
      </p>
      <p>
        The training framework used <strong>PyTorch Lightning</strong> for structure, <strong>Chemprop</strong> as a base, and traditional models such as <strong>CatBoost</strong> and <strong>scikit-learn</strong> for selected properties.  
        Hyperparameter tuning was managed by <strong>Optuna</strong>, which consumed most of the GPU hours and patience during this process.
      </p>

      <h3>Compressing a neural network into a desktop app</h3>
      <p>
        Running a heavy model in a Jupyter notebook is one thing. Running it inside a local application that must respond in seconds is another.  
        Every step of inference was profiled and reduced until predictions felt instant. Quantization and efficient data flow were critical.  
        The goal was simple: accurate predictions that appear before the user has time to think about waiting.
      </p>
      <p>
        The ADMET module is distributed as a separate add-on rather than being bundled with the main application.  
        This approach keeps InstaDock "lightweight" (LoL) and gives users control over whether they want to enable AI-based predictions.  
        It also makes the system friendlier for machines that might struggle with large model files.
      </p>

      <h3>The publishing maze</h3>
      <p>
        Alongside development, I began documenting the full process for publication.  
        The manuscript includes data preparation methods, architecture details, and integration design.  
        The feedback so far has been encouraging, although finding the right home for applied computational work can be a long journey.  
        Regardless of where it is eventually published, the module is already serving its purpose by assisting researchers in real workflows.
      </p>

      <div class="callout">
        The ADMET module is now active inside InstaDock v2, providing predictions that extend docking analysis beyond binding affinity.  
        It is practical, measurable, and designed to make early-stage screening a little less uncertain.
      </div>

	<p>
	  On a lighter note, training these models for days taught me more about heat management than I ever wanted to know.  
	  My workstation sounded like a turbine at full thrust, but at least the results were worth it.  
	  I’ve since developed a deep respect for thermal paste and, quite possibly, a mild case of Stockholm syndrome for my GPU fans.  
	</p><p>
	  P.S. I recently discovered that Stockholm syndrome isn’t actually recognized as a mental disorder.  
	  There’s barely any formal research on it beyond the 1973 bank robbery case in Stockholm that gave it its name.  
	  With a sample size of just four people, I still have no idea how it became a staple of pop psychology lore.
	</p>

    </div>

    <div class="tags">
      <span class="tag">InstaDock</span><span class="tag">AI</span><span class="tag">Software Dev</span><span class="tag">Cheminformatics</span><span class="tag">Machine Learning</span>
    </div>
    <p style="margin-top:36px;color:#94a3b8">
      Share: <a href="https://ym59.github.io/blogs/posts/building-the-admet-ai-module-for-instadock-v2.html">
      https://ym59.github.io/blogs/posts/building-the-admet-ai-module-for-instadock-v2.html</a>
    </p>
  </div>
  <script>
    (function(){
      const root=document.documentElement;
      const toggleBtn=document.getElementById('themeToggle');
      const sun=document.getElementById('sun');
      const moon=document.getElementById('moon');

      function setTheme(mode){
        if(mode==='light'){
          root.classList.add('light');
          toggleBtn?.setAttribute('aria-pressed','true');
          sun.style.display='none'; moon.style.display='block';
          localStorage.setItem('site-theme','light');
        }else{
          root.classList.remove('light');
          toggleBtn?.setAttribute('aria-pressed','false');
          sun.style.display='block'; moon.style.display='none';
          localStorage.setItem('site-theme','dark');
        }
      }

      const saved=localStorage.getItem('site-theme');
      const prefersLight=window.matchMedia('(prefers-color-scheme: light)').matches;
      setTheme(saved ? saved : (prefersLight ? 'light' : 'dark'));

      toggleBtn?.addEventListener('click',()=>{
        const next=document.documentElement.classList.contains('light')?'dark':'light';
        setTheme(next);
      });
    })();
  </script>
</body>
</html>
