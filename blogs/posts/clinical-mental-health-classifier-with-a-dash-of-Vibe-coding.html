<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Clinical mental health classifier with a dash of "Vibe coding"</title>
  <meta name="description" content="A CNN+TF-IDF ensemble wrapped in a Flask app that tries to understand Reddit posts with a safety-first crisis override.">
  <meta property="og:title" content="Praw praw and emotions">
  <meta property="og:description" content="A CNN+TF-IDF ensemble wrapped in a Flask app that tries to understand Reddit posts with a safety-first crisis override.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://ym59.github.io/blogs/posts/praw-praw-and-emotions.html">
  <meta property="og:image" content="https://ym59.github.io/images/YM.png">
  <meta property="article:published_time" content="Sep 15, 2025">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Praw praw and emotions">
  <meta name="twitter:description" content="A CNN+TF-IDF ensemble wrapped in a Flask app that tries to understand Reddit posts with a safety-first crisis override.">
  <meta name="keywords" content="Python, AI, WebDev, Reddit">

  <link rel="icon" href="../../images/YM.ico" />
  <link rel="stylesheet" href="../styles/post-common.css">
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --text:#cbd5e1;
      --muted:#94a3b8;
      --accent:#7dd3fc;
      --accent-2:#60a5fa;
      --glass:rgba(255,255,255,0.03);
      --radius:14px;
      color-scheme:dark;
      font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;
    }
    html.light{
      --bg:#f7fafc;
      --card:#ffffff;
      --text:#0b1220;
      --muted:#536171;
      --accent:#0ea5e9;
      --accent-2:#2563eb;
      --glass:rgba(2,6,23,0.05);
      color-scheme:light;
    }

    html,body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
    }
    
	.content,
	.content p,
	.content li,
	.content .callout,
	.content .callout p {
	  text-align: justify;
	  text-justify: inter-word;
	  hyphens: auto;
	  /* keep the last line readable rather than stretched */
	  text-align-last: left;
	}

	/* Optional: keep small UI elements unaffected */
	.meta, .post-top, .tags, .tag, h1, h3 {
	  text-align: left;
	}
    .container{max-width:900px;margin:0 auto;padding:28px 20px}
    h1{color:var(--accent-2)}
    .meta{color:var(--muted);font-size:0.95rem;margin-bottom:14px}
    .tags{margin-top:18px}
    .tag{display:inline-block;background:var(--glass);padding:6px 10px;border-radius:999px;margin-right:8px;color:var(--accent);border:1px solid rgba(125,211,252,0.15)}
    a.home{display:inline-block;margin-top:18px;color:var(--accent-2);text-decoration:none}
    a.home:hover{text-decoration:underline}
    .content{line-height:1.75;color:var(--text)}
    .callout{background:var(--card);border:1px solid var(--glass);padding:12px 14px;border-radius:10px}

    .post-top{display:flex;align-items:center;gap:12px;margin-bottom:6px}
    .spacer{flex:1}

	.theme-toggle{
	  width:40px;
	  height:40px;
	  padding:0;
	  border-radius:10px;
	  cursor:pointer;
	  border:1px solid var(--glass);
	  background:transparent;
	  display:inline-flex;
	  align-items:center;
	  justify-content:center;
	  color:var(--muted);
	  line-height:0;           /* no extra baseline space */
	  /* no overflow hidden here */
	  box-sizing:border-box;
	}
	.theme-toggle svg{
	  width:22px;              /* a bit larger but still safe */
	  height:22px;
	  display:block;           /* removes baseline offset */
	  overflow:visible;        /* allow stroke to extend outside viewBox */
	}
  </style>
</head>
<body>
  <div class="container">
    <div class="post-top">
      <a href="../nav.html" class="home">← Back to blog</a>
      <div class="spacer"></div>
  
      <button class="theme-toggle" id="themeToggle" aria-pressed="false" title="Toggle theme">
  	  <svg id="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
  		   fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round">
  		<circle cx="12" cy="12" r="4"></circle>
  		<path d="M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M4.93 19.07l1.41-1.41m11.32-11.32l1.41-1.41"></path>
  	  </svg>
  	  <svg id="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
  		   fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round" style="display:none">
  		<path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
  	  </svg>
  	</button>
    </div>
   
    <h1>Clinical mental health classifier with a dash of "Vibe coding"</h1>
    <div class="meta">Published: Sep 15, 2025 • Author: Yash Mathur</div>

    <div class="content">
      <h3>How it started: vibes and Reddit posts</h3>
	<p>
	  This project began with a somewhat impulsive idea: to build a system that could read Reddit posts and make sense of the writer’s mental and emotional state.  
	  Not diagnose, of course, because that would be presumptuous and unsafe, but rather to identify the tone and categorize it into broad clinical groups such as 
	  “Anxiety Disorder”, “Mood Disorder”, or “General Emotional Distress”.  
	  The intention was to make the model sensitive enough to notice when language hinted at crisis, and to respond by displaying mental health resources instead of cold predictions.  
	</p>
	<p>
	  What began as a small college experiment gradually turned into something more serious.  
	  The prototype grew into a Flask web application powered by a hybrid architecture that combines a Convolutional Neural Network (CNN) with a TF-IDF based model.  
	  To prevent it from making risky assumptions, I added a crisis override that always intervenes when certain phrases appear, no matter what the classifier believes.  
	  It is, in essence, a careful balance between machine logic and human responsibility.
	</p>

	<h3>Two brains are better than one</h3>
	<p>
	  The core of the system relies on a pair of very different models that somehow work better together than they do individually.  
	</p>
	<ul>
	  <li>The <strong>CNN</strong> functions as a pattern detector. It processes sequences of words, paying attention to context, emotion, and phrasing. It notices the subtleties that humans often describe as “tone.”</li>
	  <li>The <strong>TF-IDF model</strong> is more literal. It measures the importance of each word based on how often it appears relative to the whole dataset, grounding the intuition of the CNN in statistical reasoning.</li>
	</ul>
	<p>
	  Their predictions are averaged to create a more stable output. This approach reduces the tendency of either model to overreact to individual phrases.  
	  Confidence is assessed not only by looking at the highest probability score, but also by analyzing entropy, which provides a rough estimate of how certain the model is about its own conclusions.  
	  The combination gives the system a kind of simulated self-awareness about uncertainty, which is surprisingly useful when dealing with human language.
	</p>

	<h3>PRAW, or how I stopped worrying and learned to fetch</h3>
	<p>
	  The system draws its input from Reddit itself.  
	  When a user pastes a Reddit link, the backend attempts to retrieve the post using PRAW, Reddit’s official API wrapper.  
	  If PRAW is unavailable, it falls back to a more direct method using JSON scraping.  
	  The process is simple but surprisingly resilient. Title and body text are extracted, cleaned, and then merged into one block of content that becomes the model’s input.  
	</p>
	<p>
	  The <code>clean_text()</code> function performs the quiet, essential work of removing URLs, usernames, emojis, and general social-media debris.  
	  By the time the text reaches the classifier, it has been stripped of the noise that would otherwise confuse the models.  
	  This preprocessing step is what allows the system to stay focused on meaning rather than metadata.
	</p>

	<h3>The red button: crisis override</h3>
	<p>
	  Before any text reaches the classifier, it is screened for a curated list of crisis-related words and phrases.  
	  If one of these is detected, the system bypasses the model entirely and immediately returns crisis support resources.  
	  This design choice is deliberate. No matter how accurate the algorithm becomes, it should never be trusted to make a probabilistic judgment when someone expresses an intent to harm themselves.  
	</p>
	<div class="callout">
	  This safeguard might seem like a technical detail, but it represents the core idea behind the entire project: that data comes from people, and treating it responsibly matters more than model performance.
	</div>

	<h3>Making labels human again</h3>
	<p>
	  Many machine learning models output cryptic tags, subreddit names, or meaningless label IDs.  
	  I wanted this one to produce something that made sense to a human reader.  
	  Each classification result is mapped to a recognizable clinical category such as Anxiety Disorder, PTSD, Substance Use Disorder, or General Emotional Distress.  
	  Alongside these, the app displays a brief summary explaining what that category usually represents, along with resource links for anyone who might want help.  
	  When a message falls into a crisis category, the interface directly displays hotline numbers instead of technical information.  
	</p>
	<p>
	  The web interface is intentionally minimal. It uses Chart.js to draw confidence bars and probability charts, giving users a quick sense of how certain the system feels about its predictions.  
	  The visual feedback transforms the model’s internal math into something that feels more like a dialogue, rather than a black box issuing verdicts.
	</p>

	<h3>Structure of a tiny classifier</h3>
	<ul>
	  <li><strong>Frontend:</strong> A single HTML page that uses Bootstrap for layout and Chart.js for visualization.</li>
	  <li><strong>Backend:</strong> Flask routes for <code>/</code>, <code>/fetch</code>, and <code>/predict</code> handle all requests.</li>
	  <li><strong>Models:</strong> A CNN and a TF-IDF model whose outputs are averaged after softmax normalization.</li>
	  <li><strong>Safety:</strong> The crisis override always takes priority over classification logic.</li>
	</ul>

	<div class="callout">
	  The classifier is intentionally small and transparent.  
	  It is not built to impress benchmarks, but to explore what happens when artificial intelligence is designed to act cautiously and communicate clearly.  
	  The goal was never to replace human judgment, only to build a system that understands when to stay quiet.
	</div>


    </div>

    <div class="tags">
      <span class="tag">Python</span><span class="tag">AI</span><span class="tag">WebDev</span><span class="tag">Reddit</span>
    </div>
    <p style="margin-top:36px;color:#94a3b8">
      Share: <a href="https://ym59.github.io/blogs/posts/praw-praw-and-emotions.html">
      https://ym59.github.io/blogs/posts/praw-praw-and-emotions.html</a>
    </p>
  </div>
  <script>
    (function(){
      const root=document.documentElement;
      const toggleBtn=document.getElementById('themeToggle');
      const sun=document.getElementById('sun');
      const moon=document.getElementById('moon');

      function setTheme(mode){
        if(mode==='light'){
          root.classList.add('light');
          toggleBtn?.setAttribute('aria-pressed','true');
          sun.style.display='none'; moon.style.display='block';
          localStorage.setItem('site-theme','light');
        }else{
          root.classList.remove('light');
          toggleBtn?.setAttribute('aria-pressed','false');
          sun.style.display='block'; moon.style.display='none';
          localStorage.setItem('site-theme','dark');
        }
      }

      const saved=localStorage.getItem('site-theme');
      const prefersLight=window.matchMedia('(prefers-color-scheme: light)').matches;
      setTheme(saved ? saved : (prefersLight ? 'light' : 'dark'));

      toggleBtn?.addEventListener('click',()=>{
        const next=document.documentElement.classList.contains('light')?'dark':'light';
        setTheme(next);
      });
    })();
  </script>
</body>
</html>

